function e(e){return e*Math.PI/180}function t(e){return e/Math.PI*180}function i(e){return Math.cos(e)}function n(e){return Math.sin(e)}function r(e,t){return e>t?t:e}function a(e,t){return e<t?t:e}function o(e,t,i,n){var r=e-i,a=t-n,o=Math.sqrt(Math.pow(r,2)+Math.pow(a,2));return o<0&&(o=-o),o}function h(e){return e.charAt(0).toUpperCase()+e.slice(1)}function s(e){return e<10?"0"+e:e}function l(e){return e<100?"0"+e:e<10?"00"+e:e}function c(){var e=document.domain.split(".");location.ext=e[e.length-1],location.sub=e[e.length-3]}function d(e){var t=new Image;return t.src=e+".png",t}function u(){return"hsl("+Math.floor(255*Math.random())+", 60%, 60%)"}function w(e,t){return t++,Math.floor(Math.random()*(t-e))+e}function p(){return pe.addEventListener("click",function(e){log(e.clientX,e.clientY+scrollY)}),"I will spam you coords now!"}function f(e,t,i,n,r){fe.beginPath(),fe.arc(e,t,i,0,2*Math.PI,!1),fe.fillStyle=n,fe.strokeStyle=n,r?fe.stroke():fe.fill(),fe.closePath()}function y(e,t,i,n,r,a){fe.beginPath(),fe.moveTo(e,t),fe.lineTo(i,n),fe.lineWidth=r,fe.strokeStyle=a,fe.stroke()}function g(e,t,i,n,r,a){fe.beginPath(),fe.rect(e,t,i,n),a?(fe.strokeStyle=r,fe.stroke()):(fe.fillStyle=r,fe.fill())}function v(){fe.clearRect(5*-pe.width,5*-pe.height,5*pe.width,5*pe.height)}function x(e,t,i,n,r){fe.drawImage(e,t,i,n,r)}function m(e){fe.fillStyle=e,fe.strokeStyle=e}function b(){return!le&&(se=setInterval(W),le=!0,!0)}function M(){clearInterval(se),le=!1}function L(e){fe.globalAlpha=e}function I(e){fe.rotate(e*Math.PI/180)}function A(e,t){fe.translate(e,t)}function k(){fe.save()}function T(){fe.restore()}function D(e){for(var t=ce.length-1;t>=0;t--){var i=1e3*Math.pow(1e3,t);if(e>=i)return Math.floor(e/i*20)/20+ce[t]}return e}function O(){localStorage.removeItem("game"),location.reload()}function C(e,t,i){this.x=e,this.y=t,this.color=i,this.level=1,this.timestamp=new Date,this.powerInterval=1e3,this.nextOut=new Date,this.upgradeCost=10,this.power=1,this.stats=0,this.upgradeSpeed=.95,this.upgradePower=1.2,this.upgradeCostMultiplier=1.4,this.nextInterval=this.powerInterval*this.upgradeSpeed}function E(){var e=be.windmills.length;be.windmills.push(new C(ge[e].x,ge[e].y,"#8B8B8B"))}function S(){be.windmills.forEach((e,t)=>{var i=e.x+ke;m("white"),te(Ce,{x:i-65,y:e.y-60,width:130,height:500})?(m("white"),B(i,e.y,"#A9A9A9"),f(i,e.y,31,"aqua",!0),m("aqua")):B(i,e.y,e.color);var i=e.x-65+ke,n=e.y+380;if(k(),fe.font="19px Gloria Hallelujah",fe.fillText(`Level ${e.level}`,i+36,n+1),T(),new Date-e.nextOut>0){var r={x:ve.x,y:ve.y,t:be.battery};q(e.x-20,e.y+340,r.x,r.y,Se.power,80,function(){if(be.power+=e.power,e.stats+=e.power,r.t&&r.t.power<r.t.max&&(r.t.power+=e.power,r.t.power>=be.battery.max&&q(r.x,r.y,r.x,r.y-100,Se.fb,200)),he("#stats")){var t=he("#button");if(t){var i=t.attributes.windmill.value;e==be.windmills[i]&&(he("#stats").innerHTML=round(e.stats))}}var n=he("#batteryPower");n&&(n.innerHTML=round(be.battery.power),be.battery.power>be.battery.max&&(be.battery.power=be.battery.max),he("#batteryPercentage").innerHTML=round(be.battery.power/be.battery.max*100)),H()}),e.nextOut=(new Date).valueOf()+e.powerInterval}}),be.windmills.length<ge.length&&ge.forEach((e,t)=>{if(t>=be.windmills.length&&t<=be.windmills.length){m("white");var i=e.x+ke;te(Ce,{x:i-100,y:e.y+180,width:200,height:200})&&(L(be.cash>=e.price?.8:.3),B(i,e.y,"grey"),L(1)),m("white"),fe.roundRect(i-100,e.y+180,200,200,30).stroke(),fe.roundRect(i-10,e.y+180+50,20,100,30).fill(),fe.roundRect(i-50,e.y+180+100-10,100,20,30).fill(),fe.fillText(`${D(e.price)}`,i-25,e.y+180+200-20)}});var e=ge[0],t=e.x-43+ke;fe.roundRect(t,e.y+389,pe.hw+400-t+ke,10,10).fill()}function j(e){if(e.target===pe&&"windpark"===Ae){be.windmills.forEach((e,t)=>{if(te(Ce,{x:e.x-65+ke,y:e.y-60,width:130,height:500})){Swal.fire({showConfirmButton:!1,html:`
          <p style="margin-bottom:-0.6rem"><i class="fas fa-bolt"></i> <b id="stats">${round(e.stats)}</b><br></p>
          <h3>Windmill</h3>
          Speed: <b id="speed">${ie(1e3/e.powerInterval*e.power)}</b><i class="fas fa-bolt"></i>  / s <br>
          Level: <b id="level">${e.level}</b> <br>
          <button windmill="${t}" id="button" class="btn btn-primary">
            <i class="fas fa-arrow-up"></i>
            <i class="fas fa-dollar-sign"></i>
            <b id="upgradeCost">${round(e.upgradeCost)}</b>
          </button> <br>
          <p style="color: green;font-size:.9rem;position:absolute;right: 200px;display:inline-block;">
            <b id="nextUpgrade">${ie(1e3/e.nextInterval*e.power)}</b><i class="fas fa-bolt"></i> / s
          </p>
          <br>
          `,onBeforeOpen:()=>{H(),he("#button").addEventListener("click",P)}});var i=!0}be.windmills.length}),be.windmills.length<ge.length&&ge.forEach((e,t)=>{if(t>=be.windmills.length){te(Ce,{x:e.x-100+ke,y:e.y+180,width:200,height:200})&&be.cash>=e.price&&(be.cash-=e.price,E())}})}}function H(){var e=he("#button");if(e){var t=e.attributes.windmill.value,i=be.windmills[t];be.cash>=i.upgradeCost?(e.classList.add("btn-success"),e.classList.remove("btn-primary")):(e.classList.remove("btn-success"),e.classList.add("btn-primary"))}var n=he("#batteryGoButton");n&&(be.battery.power>=be.battery.max?(n.classList.add("btn-success"),n.classList.remove("btn-primary")):(n.classList.remove("btn-success"),n.classList.add("btn-primary")));var n=he("#batteryGoButton");n&&n.addEventListener("click",function(){if(be.battery.power>=be.battery.max){Swal.clickCancel();var e=0,t=setInterval(function(){ke-=Math.pow(e/100,3),e++,-ke>pe.w&&(Ae="fullbatterygame",me=me.filter(e=>e.img!==Se.power),xe.forEach(e=>{e.x+=ke}),ke=0,Swal.clickCancel(),clearInterval(t))})}})}function P(){var e=he("#button"),t=e.attributes.windmill.value,i=be.windmills[t];be.cash>=i.upgradeCost&&(be.cash-=i.upgradeCost,i.level++,i.powerInterval=i.nextInterval,i.power*=i.upgradePower,i.upgradeCost*=i.upgradeCostMultiplier,i.nextInterval=i.powerInterval*i.upgradeSpeed,he("#level").innerHTML=i.level,he("#upgradeCost").innerHTML=round(i.upgradeCost),he("#speed").innerHTML=ie(1e3/i.powerInterval*i.power),he("#nextUpgrade").innerHTML=ie(1e3/i.nextInterval*i.power),H())}function B(t,i,n){t-=40;x(Se.pole,t,i,400,400),k(),A(t+40,i),I(e(de)),x(Se.legs,-200,-200,400,400),T(),t+=40,f(t,i,31,n),f(t,i,10,"#dbdbdb")}function R(){Me.width=Se.player.width/2,Me.height=Se.player.height/2,Me.obj={width:Me.height,height:Me.width};var e=Se.playerside;Me.sideObj={x:pe.w+300,y:pe.h-70-e.height,width:e.width,height:e.height},se=setInterval(W);for(var t=0;t<20;t++)xe.push(new Y(1));fe.font="30px Gloria Hallelujah",De.push(new G),De.push(new G(3))}function Y(e){e?1==e?this.x=w(-400,pe.w):2==e&&(this.x=w(pe.w-ke,pe.w+100-ke)):this.x=w(-400,-200)-ke,this.y=w(0,pe.hh-100),this.speed=w(40,50)/100,this.size=w(150,250)}function z(e,t,i,n,r,a,o,h){this.x=e,this.y=t,this.startX=e,this.startY=t,this.dx=i,this.dy=n,this.img=r,this.size=a,this.cb=o,this.whenDie=(new Date).valueOf()+1e4,this.speed=h}function G(e){var t=Se.cars[w(0,Se.cars.length-1)];this.img=t;var i=t.width,n=t.height;this.width=i,this.height=n,e||(e=1),this.l=e;var r=w(0,2);this.lane=r,this.x=pe.w*e+i+2e3,this.y=ye.y+i/2+20+r*ye.h/3,this.speed=w(0,10)/10+Me.meters/100}function X(e){var t=Se.coin;if(this.img=t,!e)var e=w(0,2);this.x=pe.w+t.width/6,this.y=ye.y+t.width/6+20+e*ye.h/3,this.lane=e,this.collect=function(){q(this.x-30,this.y-30,pe.w-150,30,Se.coin,100,function(){be.cash++},.006)}}function q(e,t,i,n,r,a,o,h){me.push(new z(e,t,i,n,r,a,o,h))}function W(){if(v(),J(),"windpark"==Ae)de+=90,N(),Q(),V(),$(),S();else if("fullbatterygame"==Ae){for(var e=0;e<3;e++)x(Se.grassTop,1e3*e+ue%1e3,0,1e3,1e3);F(),U(),K(),V(),$()}ee(),ae()}function U(){Oe.length<1&&Oe.push(new X),Le.x=pe.hw,Le.lane==De[w(0,De.length-1)].lane&&(Le.lane=w(0,2),Le.y=new X(Le.lane).y,Le.choose=new Date);var e=Oe[Oe.length-1];o(new X(Le.lane).x,0,e.x,0)>200&&Oe.length<100&&new Date-Le.choose>2e3&&Oe.push(new X(Le.lane)),Oe.forEach((e,t)=>{var i=e.img.width/3,n=e.img.height/3;if(x(e.img,e.x-i/2,e.y-n/2,i,n),!Me.isDead){e.x-=Me.speed;var r={x:Me.x-Me.height/2,y:Me.y-Me.width/2};Object.assign(r,Me.obj),te(e,r)&&(Oe.splice(t,1),e.collect()),e.x<-i&&Oe.splice(t,1)}})}function K(){Me.isDead||(Me.meters+=Me.speed/200,Me.speed+=1e-4,be.battery.power-=.001);var e=Me.width,t=Me.height,i=ye.y+Me.lane*ye.h/3+105,n=i-Me.y;if(!Me.isDead&&be.battery.power>0&&(Me.y+=.05*n,Me.x=e+Te+100),!Me.isDead){var r={x:Me.x-Me.height/2,y:Me.y-Me.width/2-40};Object.assign(r,Me.obj);var a=w(0,De.length-1),h=Se.cars.map(e=>e.width).reduce(function(e,t,i){return e+(t-e)/(i+1)},0);if(r.width+=h,r.height+=80,te(De[a],r)&&Me.die("Hit another car.",De[a]),Math.abs(n)>20&&be.battery.power>0){var s=Math.sign(n);Me.x>e/2&&Te--,s==-1?Me.rotation=80:1==s&&(Me.rotation=100)}else Te<0&&(Te+=-Te/300),Me.rotation=90}if(k(),A(Me.x,Me.y),I(Me.rotation),x(Se.player,-e/2,-t/2,e,t),T(),De.forEach((e,t)=>{Me.isDead||(e.x-=Me.speed+1+e.speed),e.x>pe.width&&f(pe.width-25,e.y,(e.x-pe.width)/50,"red"),k(),A(e.x,e.y),I(90),x(e.img,-e.width/2,-e.height/2,e.width,e.height),T(),e.x+e.width/2<0&&(De.splice(t,1),De.push(new G));var i=w(0,De.length-1);o(e.x,e.y,De[i].x,De[i].y)<200&&i!==t&&(e.x+=1e3)}),Me.car){var l=Me.car,c=Se.explosion,e=c.width,t=c.height,d=Me.x-e/2,i=Me.y-t/2,u=d-l.x+l.height/2,n=i-l.y+l.width/2;x(c,d-u/2,i-n/2,e,t)}}function F(){var e=ye.w,t=ye.h,i=ye.x,n=ye.y;g(i,n,e,t,"grey");for(var r=0;r<2;r++)for(var a=0;a<12;a++)g(200*a-200+ue%200,n+(r+1)*t/3,100,10,"white");Me.isDead||(ue-=Me.speed)}function J(){x(Se.sky,0,0,pe.w,pe.h)}function N(){xe.forEach((e,t)=>{e.x+=e.speed,e.speed>.4&&e.speed<.6?e.speed+=w(-1,1)/100:e.speed<=.4?e.speed+=w(0,4)/100:e.speed>=.6&&(e.speed+=w(-4,0)/100);var i=e.x+ke;i>pe.w+200&&(xe.push(new Y),xe.splice(t,1)),i<-400&&(xe.push(new Y(2)),xe.splice(t,1)),x(Se.cloud,i,e.y,e.size,e.size)}),xe.length>500&&xe.shift()}function Q(){var e=ke,t=0,i=pe.w;if(x(Se.grass,e,t,i,1e3),k(),A(e,t),fe.scale(-1,1),x(Se.grass,0,0,i,1e3),T(),ke<0){var n=Se.road.width,r=Se.road.height;x(Se.road,pe.w+ke,pe.h-r/2,pe.w,r/n*pe.w);var a=Se.playerside,o={};Object.assign(o,Me.sideObj),o.x+=ke,te(Ce,o),x(a,o.x,o.y,o.width,o.height)}if(be.windmills.length<3){x(Se.gate,-350+ke,pe.hh,Se.gate.width/3,Se.gate.height/3),x(Se.stop,-200+ke,pe.hh,Se.stop.width/2,Se.stop.height/2),x(Se.sign,-165+ke,pe.hh+250,Se.sign.width/3,Se.sign.height/3),fe.font="15px Gloria Hallelujah";var e=-160+ke,t=pe.hh+289;fe.fillText("You need to have ",e,t),fe.fillText("3 windmills to ",e,t+15),fe.fillText("unlock this area.",e,t+30)}}function V(){var e=ve.x+ke,t=ve.y,i=ve.w,n=ve.h;be.battery.power>be.battery.max&&(be.battery.power=be.battery.max);var r=be.battery.power/be.battery.max;if("fullbatterygame"==Ae&&(e=50,t=30,be.battery.power<=0&&!Me.isDead&&(Me.speed*=.995,Me.speed<=.01&&Me.die("Out of battery"))),m("white"),"windpark"==Ae){var a={};Object.assign(a,ve.obj),a.x+=ke,te(Ce,a)&&m("#dbdbdb")}fe.roundRect(e-15,t+n/2-20,30,40,10).fill(),fe.roundRect(e,t,i,n,10).fill(),(r<0||!r)&&(r=.01),r<=.15?m("red"):r>.15&&r<.3?m("orange"):r>=.3&&m("green"),fe.roundRect(e+5,t+5,(i-10)*r,n-10,5).fill();for(var o=0;o<4;o++)g(e+5+(i-10)*(o/5+.2),t+5,3,n-10,"white")}function Z(e){if(e.target===pe&&"windpark"===Ae){var t={};Object.assign(t,ve.obj),t.x+=ke,te(Ce,t)&&Swal.fire({showConfirmButton:!1,html:`
        <p style="margin-bottom:-0.6rem"><i class="fas fa-bolt"></i> <b id="batteryPower">${round(be.battery.power)}</b><br></p>
        <h3>Battery</h3>
        <br>
        Max: <i class="fas fa-bolt"></i><b>${be.battery.max}</b> <br>
        Current: <b id="batteryPercentage">${round(be.battery.power/be.battery.max*100)}</b>%
        <br>
        <button id="batteryGoButton" class="btn btn-primary">GO</button>
        <br><br>
        `,onBeforeOpen:()=>{H()}})}}function $(){me.forEach((e,t)=>{var i=e.x+ke;x(e.img,i,e.y,e.size,e.size);var n=e.dx-e.startX,r=e.dy-e.startY,a=e.speed;a||(a=0),e.x=e.x+n*(.002+a),e.y=e.y+r*(.002+a),(o(i,e.y,e.dx+ke,e.dy)<10||new Date-e.whenDie>0)&&(e.cb&&e.cb(),me.splice(t,1))})}function _(e){if(e.target===pe&&"windpark"===Ae){var t={};Object.assign(t,Me.sideObj),t.x+=ke,te(Ce,t)&&Swal.fire({showConfirmButton:!1,html:`
        <h3>Car</h3>
        <br>
        Max: <i class="fas fa-bolt"></i><b>${be.battery.max}</b> <br>
        Current: <b id="batteryPercentage">${round(be.battery.power/be.battery.max*100)}</b>%
        <br>
        <button id="batteryGoButton" class="btn btn-primary">GO</button>
        <br><br>
        `,onBeforeOpen:()=>{H(),addEventListener}})}}function ee(){"windpark"==Ae?(he("#cashOverlay").classList.remove("hidden"),he("#gameOverlay").classList.add("hidden"),he("#power").innerHTML=round(be.power)):"fullbatterygame"==Ae&&(he("#cashOverlay").classList.add("hidden"),he("#gameOverlay").classList.remove("hidden"),he("#meters").innerHTML=round(Me.meters)),he("#cash").innerHTML=round(be.cash)}function te(e,t){return e.x>t.x&&e.y>t.y&&e.x<t.x+t.width&&e.y<t.y+t.height}function ie(e){return Math.round(100*e)/100}function ne(){var e=he("#wrap"),t=innerWidth/innerHeight,i=innerWidth,n=innerHeight;i/n>t?(i=n*t,e.style.height=n+"px",e.style.width=i+"px"):(n=i/t,e.style.width=i+"px",e.style.height=n+"px"),e.style.marginTop=-n/2+"px",e.style.marginLeft=-i/2+"px","complete"===document.readyState&&W()}function re(e){var t=pe.getBoundingClientRect(),i=pe.w/t.width;scaleY=pe.h/t.height,Ie=e,Ce.x=(e.clientX-t.left)*i,Ce.y=(e.clientY-t.top)*scaleY,ae()}function ae(){f(Ce.x,Ce.y,10,"white",!0)}function oe(e){Me.rotation=90,clearInterval(Ee);const t=Math.sign(e.deltaY);if("fullbatterygame"==Ae){if(Me.lane<=0&&t==-1)return;if(Me.lane>=2&&1==t)return;Me.lane+=t}if("windpark"==Ae){if(ke>250&&t==-1&&be.windmills.length<3)return;var i=1,n=setInterval(function(){if(ke<-pe.w&&1==t)return ke=-pe.w,void clearInterval(n);ke-=t*i,++i>10&&clearInterval(n)})}}var he=document.querySelector.bind(document);c();var se,le=!0,ce=["K","M","B","T","AA","AB","AC","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ"],de=0,ue=0,we=0;CanvasRenderingContext2D.prototype.roundRect=function(e,t,i,n,r){return i<2*r&&(r=i/2),n<2*r&&(r=n/2),this.beginPath(),this.moveTo(e+r,t),this.arcTo(e+i,t,e+i,t+n,r),this.arcTo(e+i,t+n,e,t+n,r),this.arcTo(e,t+n,e,t,r),this.arcTo(e,t,e+i,t,r),this.closePath(),this},round=Math.round;var pe=he("#canvas"),fe=pe.getContext("2d");pe.width=1920,pe.height=969,pe.w=pe.width,pe.h=pe.height,pe.hw=pe.width/2,pe.hh=pe.height/2;var ye={w:pe.w,h:600,x:0};ye.y=pe.hh-ye.h/2;var ge=[{x:pe.hw-700,y:pe.hh,price:1},{x:pe.hw-300,y:pe.hh,price:100},{x:pe.hw+100,y:pe.hh,price:1e4},{x:-pe.hw-700,y:pe.hh,price:100},{x:-pe.hw-300,y:pe.hh,price:100},{x:100-pe.hw,y:pe.hh,price:1e4},{x:500-pe.hw,y:pe.hh,price:100},{x:900-pe.hw,y:pe.hh,price:100}],ve={x:pe.hw+420,y:pe.hh+355,w:200,h:75};ve.obj={x:ve.x,y:ve.y,width:ve.w,height:ve.h};var xe=[],me=[],be={power:0,cash:0,windmills:[],battery:{power:50,max:10}},Me={x:-1e3,y:pe.hh,lane:1,rotation:90,meters:0,speed:2,isDead:!1,car:!1,die:function(e,t){t&&(Me.car=t),Me.isDead=!0,Swal.fire({title:"You Died",html:e}).then(()=>{Ae="windpark",Me.isDead=!1,Me.rotation=90,Me.meters=0,Me.lane=1,Me.car=!1,Me.speed=2,Oe=[],De=[new G,new G(3)];for(var e=0;e<20;e++)xe.push(new Y(1));var e=0;ke=-pe.w;var t=setInterval(function(){e++,(ke+=Math.pow(e/100,3))>0&&clearInterval(t)})})}},Le={x:-1e3,y:pe.hh,lane:1,choose:new Date};E();var Ie,Ae="windpark",ke=0,Te=0,De=[],Oe=[],Ce={x:-1e3,y:-1e3};ne(),addEventListener("load",R),addEventListener("resize",ne),addEventListener("mousemove",re),addEventListener("mouseup",j),addEventListener("mouseup",Z),addEventListener("mouseup",_);var Ee;addEventListener("wheel",oe);var Se={};Se.grass=d("img/grasssky"),Se.grassTop=d("img/grass"),Se.cloud=d("img/cloud"),Se.sky=d("img/sky"),Se.road=d("img/road"),Se.legs=d("img/legs"),Se.pole=d("img/pole"),Se.gate=d("img/gate"),Se.sign=d("img/sign"),Se.stop=d("img/stop"),Se.power=d("img/power"),Se.fb=d("img/full battery"),Se.cars=[];for(var je=1;je<7;je++)Se.cars.push(d(`img/cars/car${je}`));Se.player=d("img/player"),Se.playerside=d("img/playerside"),Se.coin=d("img/coin"),Se.explosion=d("img/explosion");